<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/app-route/app-route.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../../bower_components/lazy-imports/lazy-imports.html">

<dom-module id="fp-admin-page">
  <link rel="lazy-import" href="fp-categories-table.html" group="fp-categories-table">
  <link rel="lazy-import" href="fp-products-table.html" group="fp-products-table">
  <link rel="lazy-import" href="fp-category-editor.html" group="fp-category-editor">
  <link rel="lazy-import" href="fp-category-creator.html" group="fp-category-creator">

  <template>
    <template is="dom-if" if="{{signedIn}}"  restamp="true">
      <app-route route="{{route}}"
             pattern="/:page"
             data="{{routeData}}"
             tail="{{subroute}}"></app-route>

      <iron-pages id="adminPages"
                  role="main"
                  selected="[[routeData.page]]"
                  attr-for-selected="name"
                  on-iron-select="_select">

        <fp-categories-table name="categories"
                             categories="[[categories]]"></fp-categories-table>
        
        <fp-products-table name="products"
                           products="[[products]]"
                           subroute="[[subroute]]"></fp-products-table>
        <fp-category-editor name="category"
                            route="[[subroute]]"></fp-category-editor>
        <fp-category-creator name="addCategory"></fp-category-creator>
      </iron-pages>
    </template>
 </template>
 
 <script>
  Polymer({
    is: 'fp-admin-page',
    behaviors: [Polymer.LazyImportsBehavior],
    
    _select: function(e){
      this.importLazyGroup(e.detail.item.localName).then(function(results) {
        console.log(results);
        this.fire("import-loaded", results);
      }.bind(this));
    }
  });
  </script>
</dom-module>
