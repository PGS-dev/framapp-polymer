<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="toarray-behavior.html">

<dom-module id="fp-products-store">
    <template>
        <iron-ajax auto
            url="https://project-5613440220430148247.firebaseio.com/api/v1/products.json"
            handle-as="json"
            last-response="{{response}}"></iron-ajax>
    </template>
    <script>
        Polymer({

            is: 'fp-products-store',
            behaviors: [toarrayBehavior],
            properties: {
                response: Object,
                category: {
                    type: String,
                    notify: true,
                    value: ''
                },
                products: {
                    type: Array,
                    notify: true,
                    computed: '_getFiltered(category, response)',
                },
            },

            _getFiltered: function(){
                return toarrayBehavior._toArray(this.response).filter(this._filterByCategory, this);
            },

            _filterByCategory: function(element, index, array){
                return element.category == this.category || this.category == '';
            },
        });
    </script>
</dom-module>